<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Restaurant Floor Management System</title>
  <!-- Tailwind CSS (Development) -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <!-- Header -->
  <header class="bg-gray-800 text-white p-4 text-center">
      <h1 class="text-xl font-bold">Restaurant Floor Management System</h1>
  </header>

  <!-- Main Container -->
  <div class="max-w-7xl mx-auto p-4 flex flex-wrap gap-4">
    <!-- Floor Layout Section -->
    <div class="flex-[2] bg-white rounded shadow p-4">
      <!-- Floor Tabs -->
      <div class="flex gap-2 mb-4">
        <button class="floor-tab px-4 py-2 rounded bg-gray-800 text-white font-bold" data-floor="1">1st Floor</button>
        <button class="floor-tab px-4 py-2 rounded bg-gray-200 font-bold" data-floor="2">2nd Floor</button>
      </div>

      <!-- Floor 1 Content -->
      <div id="floor-1" class="floor-content block">
        <h2 class="text-lg font-semibold mb-2">First Floor</h2>
        <div id="floor-1-layout" class="restaurant-layout grid grid-cols-3 gap-2 p-2 border-2 border-gray-300 bg-white"></div>
      </div>

      <!-- Floor 2 Content -->
      <div id="floor-2" class="floor-content hidden">
        <h2 class="text-lg font-semibold mb-2">Second Floor</h2>
        <div id="floor-2-layout" class="restaurant-layout grid grid-cols-3 gap-2 p-2 border-2 border-gray-300 bg-white"></div>
      </div>
    </div>

    <!-- Order Panel Section -->
    <div class="order-panel flex-1 bg-white rounded shadow p-4">
      <h2 class="text-lg font-semibold">Order Management</h2>

      <!-- Order Form -->
      <form id="orderForm" class="order-form mt-4">
        <label class="block mb-2">
          Select Table:
          <select name="tableId" id="tableSelect" required class="w-full p-2 mb-4 border border-gray-300 rounded">
            <option value="">Choose a table</option>
          </select>
        </label>

        <label class="block mb-2">
          Number of Guests:
          <input
            type="number"
            name="guestCount"
            id="guestCount"
            min="1"
            required
            class="w-full p-2 mb-4 border border-gray-300 rounded"
          />
        </label>

        <label class="block mb-2">
          Special Requirements:
          <textarea
            name="specialRequirements"
            id="specialRequirements"
            rows="2"
            class="w-full p-2 mb-4 border border-gray-300 rounded"
            placeholder="Enter any special requirements or allergies"
          ></textarea>
        </label>

        <button
          type="submit"
          class="w-full p-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"
        >
          Confirm Order
        </button>
      </form>

      <!-- Order List -->
      <div class="order-list mt-4 max-h-48 overflow-y-auto">
        <h3 class="font-semibold">Current Orders</h3>
        <div id="orderList"></div>
      </div>
    </div>
  </div>

  <!-- Inline Script Logic -->
  <script>
    // Table data for each floor
    const floorData = {
      1: [
        { id: "F1-T1", seats: 2, status: "available" },
        { id: "F1-T2", seats: 4, status: "available" },
        { id: "F1-T3", seats: 4, status: "available" },
        { id: "F1-T4", seats: 2, status: "available" },
        { id: "F1-T5", seats: 6, status: "available" },
        { id: "F1-T6", seats: 4, status: "available" }
      ],
      2: [
        { id: "F2-T1", seats: 6, status: "available" },
        { id: "F2-T2", seats: 6, status: "available" },
        { id: "F2-T3", seats: 8, status: "available" },
        { id: "F2-T4", seats: 8, status: "available" }
      ]
    };

    // Grab floor tabs and contents
    const floorTabs = document.querySelectorAll('.floor-tab');
    const floorContents = document.querySelectorAll('.floor-content');

    // Switch floor function
    function switchFloor(floor) {
      // Toggle tab styles
      floorTabs.forEach(tab => {
        tab.classList.remove('bg-gray-800', 'text-white');
        tab.classList.add('bg-gray-200');
      });

      // Activate the clicked tab
      const activeTab = document.querySelector(`.floor-tab[data-floor="${floor}"]`);
      activeTab.classList.remove('bg-gray-200');
      activeTab.classList.add('bg-gray-800', 'text-white');

      // Hide all floor content
      floorContents.forEach(content => content.classList.add('hidden'));

      // Show the selected floor
      const activeFloor = document.getElementById(`floor-${floor}`);
      activeFloor.classList.remove('hidden');
      activeFloor.classList.add('block');

      // Rerender tables
      renderTables(floor);
      updateTableSelect();
    }

    // Event listeners for floor tabs
    floorTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const floor = tab.getAttribute('data-floor');
        switchFloor(floor);
      });
    });

    // Render the tables for a given floor
    function renderTables(floor) {
      const layout = document.getElementById(`floor-${floor}-layout`);
      layout.innerHTML = '';

      floorData[floor].forEach(table => {
        const tableDiv = document.createElement('div');
        tableDiv.classList.add(
          'table',
          'flex',
          'justify-center',
          'items-center',
          'w-24',
          'h-16',
          'rounded',
          'text-sm',
          'cursor-pointer',
          'transition-colors',
          'duration-300'
        );
        // status style
        if (table.status === "available") {
          tableDiv.classList.add('bg-green-600', 'text-white');
        } else {
          tableDiv.classList.add('bg-orange-600', 'text-white');
        }

        tableDiv.innerText = `${table.id}\n${table.seats} seats`;
        tableDiv.dataset.id = table.id;

        tableDiv.addEventListener('click', () => {
          toggleTableStatus(floor, table);
        });

        layout.appendChild(tableDiv);
      });
    }

    // Toggle table status (available <-> occupied)
    function toggleTableStatus(floor, table) {
      if (table.status === "available") {
        table.status = "occupied";
      } else {
        table.status = "available";
      }
      renderTables(floor);
      updateTableSelect();
    }

    // Update the <select> list of available tables for ordering
    function updateTableSelect() {
      const tableSelect = document.getElementById('tableSelect');
      tableSelect.innerHTML = '<option value="">Choose a table</option>';

      Object.entries(floorData).forEach(([floor, tables]) => {
        // Create an optgroup for each floor
        const floorGroup = document.createElement('optgroup');
        floorGroup.label = `Floor ${floor}`;

        tables
          .filter(table => table.status === "available")
          .forEach(table => {
            const option = document.createElement('option');
            option.value = table.id;
            option.textContent = `${table.id} (${table.seats} seats)`;
            floorGroup.appendChild(option);
          });

        if (floorGroup.children.length > 0) {
          tableSelect.appendChild(floorGroup);
        }
      });
    }

    // Handle submit of the order form
    document.getElementById('orderForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const tableId = document.getElementById('tableSelect').value;
      const guestCount = document.getElementById('guestCount').value;
      const specialRequirements = document.getElementById('specialRequirements').value;

      if (!tableId) {
        alert("Please select a table");
        return;
      }

      // Check capacity
      const selectedTable = Object.values(floorData)
        .flat()
        .find(t => t.id === tableId);

      if (parseInt(guestCount) > selectedTable.seats) {
        alert(`This table only seats ${selectedTable.seats} guests`);
        return;
      }

      // Mark table as occupied
      for (const [floor, tables] of Object.entries(floorData)) {
        const table = tables.find(t => t.id === tableId);
        if (table) {
          table.status = "occupied";
          renderTables(floor);
          break;
        }
      }

      // Display the new order
      const orderItem = document.createElement('div');
      orderItem.classList.add('order-item', 'p-2', 'border-b', 'border-gray-200');
      orderItem.innerHTML = `
        <strong>Table: ${tableId}</strong><br>
        Guests: ${guestCount}<br>
        ${specialRequirements ? `Special Requirements: ${specialRequirements}<br>` : ''}
        Status: Order in progress<br>
        <button class="bg-blue-600 text-white px-2 py-1 rounded mt-1" onclick="completeOrder('${tableId}')">Complete Order</button>
      `;

      document.getElementById('orderList').appendChild(orderItem);

      // Reset form and re-render table select
      this.reset();
      updateTableSelect();
    });

    // Complete an order
    function completeOrder(tableId) {
      for (const [floor, tables] of Object.entries(floorData)) {
        const table = tables.find(t => t.id === tableId);
        if (table) {
          table.status = "available";
          renderTables(floor);
          break;
        }
      }

      // Remove order from order list
      const orderItems = document.querySelectorAll('.order-item');
      orderItems.forEach(item => {
        if (item.innerHTML.includes(tableId)) {
          item.remove();
        }
      });

      updateTableSelect();
    }

    // Initialize
    switchFloor('1');
  </script>
</body>
</html>